<!DOCTYPE html>
<html>
<head>
    <title>ANZ Netball Championship</title>
    <link rel="shortcut icon" type="image/x-icon" href="data/anzico.ico">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet"  href="styl.css">
    <script type="text/javascript" src="http://d3js.org/d3.v2.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type="text/css">
        body {
            font: 10px sans-serif;}

        #title {
            text-align: center;
            text-align: center;
            color: white;
            text-shadow: 2px 2px black;
            border-color: #FFFAF0;
            background-color: #2E9AFE;}

        #teams{
            text-align: center;
            background-color: #58ACFA;}

        #ANZ {
            text-align: center;}
        
        #rounds {
            text-align: left;
            color: blue; }

        #years {
            text-align: left;
            color: blue;}

        #table {
        border-collapse: collapse;
        border: 2px black solid;
        font: 12px sans-serif;
        text-align: center;}

        #td {
        border: 1px black solid;
        padding: 5px;
        text-align: center;}

        .bar {
            fill: #1b8053;}

        .text{
            fill: black;}

        .axis {
            font: 10px sans-serif;
            fill: white;}

        .axis path,
        .axis line {
            fill: none;
            stroke: #000;
            shape-rendering: crispEdges;}

        .arc path {
            stroke: #fff;}

        .x.axis path {
            display: none;}

        table {
            border-collapse: collapse;
            border: 2px black solid;
            font: 12px sans-serif;}

        td {
            border: 1px black solid;
            padding: 5px;}

        *{box-sizing: border-box;}

        .header {
            background-color: #000000;
            padding: 15px;}

        .row:after {
            content: "";
            clear: both;
            background-color: #333333;
            display: block;}

        [class*="col-"] {
            float: left;
            padding: 15px;
            background-color: #333333;}

        .col-1 {width: 8.33%;}
        .col-2 {width: 16.66%;}
        .col-3 {width: 25%;}
        .col-4 {width: 33.33%;}
        .col-5 {width: 41.66%;}
        .col-6 {width: 50%;}
        .col-7 {width: 58.33%;}
        .col-8 {width: 66.66%;}
        .col-9 {width: 75%;}
        .col-10 {width: 83.33%;}
        .col-11 {width: 91.66%;}
        .col-12 {width: 100%;}

        .arc path {
            stroke: #fff;
        }
.chart rect {
  fill: steelblue;
}

.chart .legend {
  fill: black;
  font: 14px sans-serif;
  text-anchor: start;
  font-size: 12px;
}

.chart text {
  fill: white;
  font: 10px sans-serif;
  text-anchor: end;
}

.chart .label {
  fill: black;
  font: 14px sans-serif;
  text-anchor: end;
}

.bar:hover {
  fill: brown;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}
    </style>
</head>
<body>
<div class="row"> 
<div class="col-4">
<img name="nzteams" src="data/NZ.JPG" align="left" style="margin-left:205px" width="95" height="65" border="8" alt="NZ Flag"></br></br></br></br></br>
<!--NZ teams-->
    <a id="pulse" href="#" onMouseDown="return mouseOverPulseMDown()" onMouseUp="return mouseOverPulseMUp()">
        <img name="pulseButton" src="data/CentralPulse.png" align="left" title="Central Pulse" width="100" height="100" border="5"
            alt="Central Pulse"></a>
        
    <a id="mystic" href="#" onMouseDown="return mouseOverMysticsMDown()" onMouseUp="return mouseOverMysticsMUp()">
        <img name="mysticsButton" src="data/NorthernMystics.png" align="left" title="Northern Mystics" width="100" height="100" border="5"
            alt="Northern Mystics"></a>

    <a id="magic" href="#" onMouseDown="return mouseOverMagicMDown()" onMouseUp="return mouseOverMagicMUp()">
        <img name="magicButton" src="data/WaikatoBayofPlentyMagic.png" align="left" title="Waikato Bay of Plenty Magics" width="100" height="100" border="5"
            alt="Waikato Bay of Plenty Magics"></a>

    <a id="steel" href="#" onMouseDown="return mouseOverSteelMDown()" onMouseUp="return mouseOverSteelMUp()">
        <img name="steelButton" src="data/SouthernSteel.png" align="left" title="Southern Steel" width="100" height="100" border="5"
            alt="Southern Steel"></a>

    <a id="tactix" href="#" onMouseDown="return mouseOverTactixMDown()" onMouseUp="return mouseOverTactixMUp()">
        <img name="tactixButton" src="data/CanterburyTactix.png" align="left" title="Canterbury Tactix" width="100" height="100" border="5"
            alt="Canterbury Tactix"></a>

</div>

<div class="col-4"> <a href="index.html" onMouseDown="return mouseOveranzMDown()" onMouseUp="return mouseOveranzMUp()">
        <img name="anzButton" src="data/anz.png" align="left" style="margin-left:185px" width="170" height="170" border="0" alt="ANZ Championship Logo"></a>
</div>

<div class="col-4">
<img name="nzteams" src="data/AUS.JPG" align="right" style="margin-right:205px" width="90" height="60" corder-color="clear" border="8"
            alt="AUS Flag"></br></br></br></br></br>


  <a id="swift" href="#" onMouseDown="return mouseOverSwiftsMDown()" onMouseUp="return mouseOverSwiftsMUp()">
        <img name="swiftsButton" src="data/NewSouthWalesSwifts.png" title="NSW Swifts" align="right"
            width="100" height="100" border="5" alt="NSW Swifts"></a>

    <a id="thunder" href="#" onMouseDown="return mouseOverThunderMDown()" onMouseUp="return mouseOverThunderMUp()">
        <img name="thunderButton" src="data/AdelaideThunderbirds.png" align="right" title="Adalaide Thunderbirds" width="100" height="100" border="5"
            alt="Adalaide Thunderbirds"></a>

    <a id="vixens" href="#" onMouseDown="return mouseOverVixensMDown()" onMouseUp="return mouseOverVixensMUp()">
        <img name="vixensButton" src="data/MelbourneVixens.png" align="right" title="Melbourne Vixens" width="100" height="100" border="5"
            alt="Melbourne Vixens"></a>

    <a id="fever" href="#" onMouseDown="return mouseOverFeverMDown()" onMouseUp="return mouseOverFeverMUp()">
        <img name="feverButton" src="data/WestCoastFever.png" align="right" title="West Coast Fever" width="100" height="100" border="5"
            alt="West Coast Fever"></a>

    <a id="fire" href="#" onMouseDown="return mouseOverFirebirdsMDown()" onMouseUp="return mouseOverFirebirdsMUp()">
        <img name="firebirdsButton" src="data/QueenslandFirebirds.png" align="right" title="Queensland Firebirds" width="100" height="100" border="5"
            alt="Queensland Firebirds"></a>
</div>
</div>
</div>

<!-- /////////////////////// MENU ///////////////////////////////////////////-->
<div id='cssmenu'>
<ul>
   <li><a href='index.html'><span>Home</span></a></li>
   <li class='active has-sub' id="years2"><a href='#'><span id="y">Year</span></a>
      <ul>
         <li id="allYears" class='has-sub'><a href='#' value="allYears"><span>All Years</span></a></li>
        <li id="y2008" class='has-sub'><a href='#' value="2008"><span>2008</span></a></li>
        <li id="y2009" class='has-sub'><a href='#' value="2009"><span>2009</span></a></li>
        <li id="y2010" class='has-sub'><a href='#' value="2010"><span>2010</span></a></li>
        <li id="y2011" class='has-sub'><a href='#' value="2011"><span>2011</span></a></li>
        <li id="y2012" class='has-sub'><a href='#' value="2012"><span>2012</span></a></li>
          <li id="y2013" class='has-sub'><a href='#' value="2013"><span>2013</span></a></li>


      </ul>
   </li>
   </li>
   <li class='active has-sub' id="rounds2"><a href='#'><span>Round</span></a>
    <ul>
        <li class='has-sub'><a href='#' value="AllRounds"><span>All Rounds</span></a></li>
        <li class='has-sub'><a href='#'value="Round 1"><span>Round 1</span></a></li>
        <li class='has-sub'><a href='#' value="Round 2"><span>Round 2</span></a></li>
        <li class='has-sub'><a href='#' value="Round 3"><span>Round 3</span></a></li>
        <li class='has-sub'><a href='#' value="Round 4"><span>Round 4</span></a></li>
        <li class='has-sub'><a href='#' value="Round 5"><span>Round 5</span></a></li>
        <li class='has-sub'><a href='#' value="Round 6"><span>Round 6</span></a></li>
        <li class='has-sub'><a href='#' value="Round 7"><span>Round 7</span></a></li>
        <li class='has-sub'><a href='#' value="Round 8"><span>Round 8</span></a></li>
        <li class='has-sub'><a href='#' value="Round 9"><span>Round 9</span></a></li>
        <li class='has-sub'><a href='#' value="Round 10"><span>Round 10</span></a></li>
        <li class='has-sub'><a href='#' value="Round 11"><span>Round 11</span></a></li>
        <li class='has-sub'><a href='#' value="Round 12"><span>Round 12</span></a></li>
        <li class='has-sub'><a href='#' value="Round 13"><span>Round 13</span></a></li>
        <li class='has-sub'><a href='#' value="Round 14"><span>Round 14</span></a></li>
        <li class='has-sub'><a href='#' value="Round 15"><span>Round 15</span></a></li>
        <li class='has-sub'><a href='#' value="Round 16"><span>Round 16</span></a></li>
        <li class='has-sub'><a href='#' value="Round 17"><span>Round 17</span></a></li>
        <li class='has-sub'><a href='#' value="Finals"><span>Finals</span></a></li>

      </ul>
   </li>
   </li>
   <li class='last'><a href='#'><span>          </span></a></li>
   <li id="display"><a href='#' onclick="chosen()"><span>Display</span></a></li>
   <li id="totalWins" href='#' onclick="drawGraph()"><a href='#' ><span>Total Wins</span></a></li>
   <li id="H2H"><a href='bubble.html' onclick="H2H()"><span>Head to Head</span></a></li>
   <li id="teamStat"><a href='#'><span>Team Stats</span></a></li>
   <li id="showAllByes"><a href='#' onclick="showByes()"><span>Show Byes</span></a></li>
   <li id="showAllData"><a href='#' onclick="showData()"><span>Show All Data</span></a></li>
</ul>
</div>
<!-- /////////////////////// MENU END ///////////////////////////////////////////-->

<!--//////////////////////////////////////////////////////////////////////////////////-->

<div class="chart"></div>
<svg class="chart"></svg>
<div id="tooltip" class="hidden">

    <p><span id="value">100</span>
    </p>
</div>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script>
var comparing = [];
function clear(elementID){
document.getElementById(elementID).innerHTML="";
}
function refreshGraph(){
    currentYear = getYearForm();
    currentRound = getRoundForm();
    d3.select("svg").remove();
    manipulateData();
}
//get all aus teams
function getAllAusDown(){
    mouseOverFeverMDown();
    mouseOverThunderMDown();
    mouseOverFirebirdsMDown();
    mouseOverVixensMDown();
    mouseOverSwiftsMDown();
}
function getAllAusUp(){
    mouseOverFeverMUp();
    mouseOverThunderMUp();
    mouseOverFirebirdsMUp();
    mouseOverVixensMUp();
    mouseOverSwiftsMUp();
}
//get all NZ teams
function getAllNzDown(){
    mouseOverMagicMDown();
    mouseOverSteelMDown();
    mouseOverPulseMDown();
    mouseOverTactixMDown();
    mouseOverMysticsMDown();
}
function getAllNzUp(){
    mouseOverMagicMUp();
    mouseOverSteelMUp();
    mouseOverPulseMUp();
    mouseOverTactixMUp();
    mouseOverMysticsMUp();
}

function makeDonutHome(){
    currentYear = getYearForm();
    currentRound = getRoundForm();
    d3.select("svg").remove();
    manipulateDataDonut(true);
}
function makeDonutAway(){
    currentYear = getYearForm();
    currentRound = getRoundForm();
    d3.select("svg").remove();
    manipulateDataDonut(false);
}
/////////////////////// SHOW ALL BYES /////////////////////////////////////////////////////
function showByes(){
    d3.select("table")
            .remove();
    d3.select("svg")
            .remove();
    d3.text("Byes.csv", function(data) {               
                var parsedCSV = d3.csv.parseRows(data);
                var container = d3.select("body")
                    .append("table")
                    .selectAll("tr")
                        .data(parsedCSV).enter()
                        .append("tr")
                    .selectAll("td")
                        .data(function(d) { return d; }).enter()
                        .append("td")
                        .text(function(d) { return d; })
                        .transition()
                        .delay(500)
                        ;
            });
}
////////////////////// SHOW ALL BYES ENDS ///////////////////////////////////////////////////
////////////////////// SHOW ALL DATA ////////////////////////////////////////////////////////
function showData(){
    d3.select("table")
            .remove();
    d3.select("svg")
            .remove();
    d3.text("fullDataNoByes.csv", function(data) {               
                var parsedCSV = d3.csv.parseRows(data);
                var container = d3.select("body")
                    .append("table")
                    .selectAll("tr")
                        .data(parsedCSV).enter()
                        .append("tr")
                    .selectAll("td")
                        .data(function(d) { return d; }).enter()
                        .append("td")
                        .text(function(d) { return d; })
                        .transition()
                        .delay(500)
                        ;
            });
}
///////////////////// SHOW ALL DATA ENDS ////////////////////////////////////////////////////

//show all byes in a table
var showBye = d3.select("body").select("#showAllByes");
showBye.on("click", function(){
   showByes();
});

//show all data
var showD = d3.select("body").select("#showAllData");
showD.on("click", function(){
    showData();
});

//show all data
var showH = d3.select("body").select("#H2H");
showH.on("click", function(){
    var selected = comparing;
    sessionStorage.setItem('map', JSON.stringify(map));
    if(selected.length<1){
        selected = ["New South Wales Swifts", "Waikato Bay of Plenty Magic", "Southern Steel", "Central Pulse", "Northern Mystics", "Melbourne Vixens", "Queensland Firebirds", "Adelaide Thunderbirds", "Canterbury Tactix", "West Coast Fever"];
    }
    sessionStorage.setItem('selected', JSON.stringify(selected));
});

//show all data
var showTeamStat = d3.select("body").select("#teamStat");
showTeamStat.on("click", function(){
    drawPie();
});



var k;
var m;
function chosen(){
    file = d3.select("body").select("#years2").node().value;
    file = file+"-Table1.csv";
    round = d3.select("body").select("#rounds2").node().value;
d3.csv(file, function(error, data) { 
    m = data;
    m.forEach(function(d){
        if(d["Round"]===round){
            k.push(d);
        }
    
        var parsedCSV = d3.csv.parseRows(k);
        var container = d3.select("body")
        .append("table")
        .selectAll("tr")
        .data(parsedCSV).enter()
        .append("tr")
        .selectAll("td")
        .data(function(d) { return d; }).enter()
        .append("td")
        .text(function(d) { return d; });
    });
    }); 
}
////////////////// HEAD TO HEAD ///////////////////////////////////////////////////////////
function H2H(){
var data = {
  labels: [
    'resilience', 'maintainability', 'accessibility',
    'uptime', 'functionality', 'impact'
  ],
  series: [
    {
      label: '2012',
      values: [4, 8, 15, 16, 23, 42]
    },
    {
      label: '2013',
      values: [12, 43, 22, 11, 73, 25]
    },
    {
      label: '2014',
      values: [31, 28, 14, 8, 15, 21]
    },]
};

var chartWidth       = 300,
    barHeight        = 20,
    groupHeight      = barHeight * data.series.length,
    gapBetweenGroups = 10,
    spaceForLabels   = 150,
    spaceForLegend   = 150;

// Zip the series data together (first values, second values, etc.)
var zippedData = [];
for (var i=0; i<data.labels.length; i++) {
  for (var j=0; j<data.series.length; j++) {
    zippedData.push(data.series[j].values[i]);
  }
}

// Color scale
var color = d3.scale.category20();
var chartHeight = barHeight * zippedData.length + gapBetweenGroups * data.labels.length;

var x = d3.scale.linear()
    .domain([0, d3.max(zippedData)])
    .range([0, chartWidth]);

var y = d3.scale.linear()
    .range([chartHeight + gapBetweenGroups, 0]);

var yAxis = d3.svg.axis()
    .scale(y)
    .tickFormat('')
    .tickSize(0)
    .orient("left");

// Specify the chart area and dimensions
var chart = d3.select(".chart")
    .attr("width", spaceForLabels + chartWidth + spaceForLegend)
    .attr("height", chartHeight);

// Create bars
var bar = chart.selectAll("g")
    .data(zippedData)
    .enter().append("g")
    .attr("transform", function(d, i) {
      return "translate(" + spaceForLabels + "," + (i * barHeight + gapBetweenGroups * (0.5 + Math.floor(i/data.series.length))) + ")";
    });

// Create rectangles of the correct width
bar.append("rect")
    .attr("fill", function(d,i) { return color(i % data.series.length); })
    .attr("class", "bar")
    .attr("width", x)
    .attr("height", barHeight - 1);

// Add text label in bar
bar.append("text")
    .attr("x", function(d) { return x(d) - 3; })
    .attr("y", barHeight / 2)
    .attr("fill", "red")
    .attr("dy", ".35em")
    .text(function(d) { return d; });

// Draw labels
bar.append("text")
    .attr("class", "label")
    .attr("x", function(d) { return - 10; })
    .attr("y", groupHeight / 2)
    .attr("dy", ".35em")
    .text(function(d,i) {
      if (i % data.series.length === 0)
        return data.labels[Math.floor(i/data.series.length)];
      else
        return ""});

chart.append("g")
      .attr("class", "y axis")
      .attr("transform", "translate(" + spaceForLabels + ", " + -gapBetweenGroups/2 + ")")
      .call(yAxis);

// Draw legend
var legendRectSize = 18,
    legendSpacing  = 4;

var legend = chart.selectAll('.legend')
    .data(data.series)
    .enter()
    .append('g')
    .attr('transform', function (d, i) {
        var height = legendRectSize + legendSpacing;
        var offset = -gapBetweenGroups/2;
        var horz = spaceForLabels + chartWidth + 40 - legendRectSize;
        var vert = i * height - offset;
        return 'translate(' + horz + ',' + vert + ')';
    });

legend.append('rect')
    .attr('width', legendRectSize)
    .attr('height', legendRectSize)
    .style('fill', function (d, i) { return color(i); })
    .style('stroke', function (d, i) { return color(i); });

legend.append('text')
    .attr('class', 'legend')
    .attr('x', legendRectSize + legendSpacing)
    .attr('y', legendRectSize - legendSpacing)
    .text(function (d) { return d.label;});
}

//////////////////// HEAD TO HEAD ENDS ///////////////////////////////////////////////////
</script>

<!--///////////// TOTAL WINS GRAPH ////////////////////////////////////////////////////-->
<div id="bar"><p>
</div>
<script>
    function getYear(){
        var y2008 = d3.select("body").select("#y2008");
        y2008.on("click", function(){
            year = 2008;
            document.getElementById("y").innerHTML = year;
            file = year+"-Table1.csv";
            read();
        });
        var y2009 = d3.select("body").select("#y2009");
        y2009.on("click", function(){
            year = 2009;
            document.getElementById("y").innerHTML = year;
            file = year+"-Table1.csv";
            read();
        });
        var y2010 = d3.select("body").select("#y2010");
        y2010.on("click", function(){
            year = 2010;
            document.getElementById("y").innerHTML = year;
            file = year+"-Table1.csv";
            read();
        });
        var y2011 = d3.select("body").select("#y2011");
        y2011.on("click", function(){
            year = 2011;
            document.getElementById("y").innerHTML = year;
            file = year+"-Table1.csv";
            read();
        });
        var y2012 = d3.select("body").select("#y2012");
        y2012.on("click", function(){
            year = 2012;
            document.getElementById("y").innerHTML = year;
            file = year+"-Table1.csv";
            read();
        });
        var y2013 = d3.select("body").select("#y2013");
        y2013.on("click", function(){
            year = 2013;
            document.getElementById("y").innerHTML = year;
            file = year+"-Table1.csv";
            read();
        });

    }


</script>
<script>

    var year;
    getYear();


    d3.select("body").select("#bar").attr("width", 1000).attr("height", 1000);
    var file = "2012-Table1.csv";
    var button4 = d3.select("body").select("#totalWins");
    button4.on("click", function(){
//        file = year+"-Table1.csv";
//        alert(file);
        read();
        drawGraph();
    });

    var h = 1000;
    var w = 1000;
    var height = 1000;
    var width = 1000;
    var padding = 80;
    var ds;
    var map = new Object();


    function read(){
        d3.csv(file, function(error, data) {
            map = new Object();
            initializeTeams();
            ds = data;

            if(file==="2008-Table1.csv"||file==="2009-Table1.csv"){
            for (var i =0;i<ds.length;i++) {
                        var temp = ds[i];
                        if (temp["Date"].substring(0,5)==="BYES:") {
                            ds.splice(i,1);
                        }
                        else {
                            var first = temp["Score"].substring(0,2);
                            var second = temp["Score"].substring(3,5);
                            ds[i]["Score"] = first+" – "+second;
                        }
                      }
                }
            ds.forEach(function (d) {
                d["Score1"] = +d['Score'].split(' – ')[0]
                d["Score2"] = +d['Score'].split(' – ')[1]
                d["Round"] = +d.Round;
                //if (d.Venue.length !== (0)) {
                d["ScoreDiff"] = +Math.abs(d.Score1 - d.Score2);
                var winner = findWinner(d["Home Team"], d["Score1"], d["Away Team"], d["Score2"]);
                d["Outcome"] = winner;
                var homeTeam = d["Home Team"];
                var awayTeam = d["Away Team"];
                var totalScoreH = d["Score1"];
                var totalScoreA = d["Score2"];
//                alert(totalScoreH+" home; away "+totalScoreA);
                if (winner == "draw" && d.Venue.length !== (0)) {
                }
                if (winner === d["Home Team"] && d.Venue.length !== (0)) {
//                    map[winner]["Round"] = d["Round"];
                    map[winner]["TotalScore"] +=totalScoreH;
                    map[winner]["TotalScoreAgainst"] +=totalScoreA;
//                    alert(map[winner]["TotalScore"]);
                    map[winner]["points"] += 2;
                    map[winner]["numOfGamesToPoints"].push(map[winner]["points"]);
                    map[d["Away Team"]]["numOfGamesToPoints"].push(map[d["Away Team"]]["points"]);
                    d["Loss"] = d["Away Team"];
                }
                if (winner === d["Away Team"] && d.Venue.length !== (0)) {
                    map[winner]["TotalScore"] +=totalScoreA;
                    map[winner]["TotalScoreAgainst"] +=totalScoreH;
                    map[winner]["points"] += 2;
                    map[winner]["numOfGamesToPoints"].push(map[winner]["points"]);
                    map[d["Home Team"]]["numOfGamesToPoints"].push(map[d["Home Team"]]["points"]);
                    d["Lost"] = d["Home Team"];
                }

            });
            calculateTotalPointsPerSeason(ds);
            calculateTotalWinLoss();
//            drawGraph(ds);
        });
    }


    function drawLinegraph() {

        var teams = new Array();
        var points = new Array();

        for (var key in map) {
            if(teamPicked(map[key].name)){
                teams.push(map[key]);
            }
        }

        for (var i = 0; i < teams.length; i++) {

            for (var j = 0; j < teams[i]["numOfGamesToPoints"].length; j++) {
                points.push(teams[i]["numOfGamesToPoints"][j]);
            }
        }
        //console.log(teams[0]["numOfGamesToPoints"]);

        var yScale = d3.scale.linear()
                .domain([
                    d3.min(points, function (d, i) {
                        return 0;
                    }),
                    d3.max(points, function (d, i) {
                        return d;
                    })
                ]).range([600, 100]);

        var xScale = d3.scale.linear()
                .domain([
                    d3.min(points, function (d, i) {
                        return 0;
                    }),
                    d3.max(points, function (d, i) {
                        return 12+d;
                    })
                ]).range([100, 1000]);


        var yAxisGen = d3.svg.axis().scale(yScale).orient("left").ticks(8);
        var xAxisGen = d3.svg.axis().scale(xScale).orient("bottom").ticks(14);

        var lineGraph = d3.svg.line()
                .x(function (d, i) {
                    // console.log(i);
                    return xScale(i);
                })
                .y(function (d, i) {
                    //console.log(d);
                    return yScale(d);
                })
                .interpolate("linear");

        var svg = d3.select("body").append("svg").attr({
            width: w,
            height: 700
        });
        var dots = svg.selectAll("g.circle")
                .data(teams)
                .enter()
                .append("g")
                .attr("class", "circle");
        var selection = dots.selectAll("circle")
                .data(function (d) {
                    return d["numOfGamesToPoints"];
                })
                .enter()
                .append("circle")
                .attr("cx", function (d, i) {

                    return xScale(i);
                })
                .attr("cy", function (d) {
                    return yScale(d);
                })
                .attr("r", 7)
                .on("mouseover", function (d, i, j) {

                    d3.select(this).classed("circle--hover", true);
                    //Get this bar's x/y values, then augment for the tooltip
                    var xPosition = parseFloat(d3.select(this).attr("cx"));
                    var yPosition = parseFloat(d3.select(this).attr("cy"));
                    console.log(yPosition);
                    //Update the tooltip position and value
                    d3.select("#tooltip")
                            .style("left", xPosition + "px")
                            .style("top", (yPosition + 240)+ "px")
                            .select("#value")
                            .text(function(){
                                var holder;
                                if(selection[j].parentNode.__data__.numOfGamesToPoints[i]>selection[j].parentNode.__data__.numOfGamesToPoints[i-1]){
                                    holder = selection[j].parentNode.__data__.name+" Won \n Season Point "+selection[j].parentNode.__data__.numOfGamesToPoints[i];
                                }else{
                                    holder = selection[j].parentNode.__data__.name+" Lost \n Season Point "+selection[j].parentNode.__data__.numOfGamesToPoints[i];

                                }
                                return holder;
                            });

                    //Show the tooltip
                    d3.select("#tooltip").classed("hidden", false);
                }).on("mouseout", function (d) {
                    d3.select(this).classed("circle--hover", false);
                    d3.select("#tooltip").classed("hidden", true);
                });



        var yAxis = svg.append("g").call(yAxisGen)
                .attr("class", "axis")
                .attr("transform", "translate(" + padding + ",0)");

        var xAxis = svg.append("g").call(xAxisGen)
                .attr("class", "axis")
                .attr("transform", "translate(0," + (700 - padding) + ")");


        var viz = svg.selectAll('.line')
                .data(teams)
                .enter()
                .append("path")
                .attr({
                    d: function (d) {
                        return lineGraph(d["numOfGamesToPoints"])
                    },

                    "stroke": function (d, i) {
                        return TeamcolorPicker(d.name);
                    },
                    "stroke-width": 2,
                    "fill": "none"
                }).on("mouseover", function (d, i, j) {

                    d3.select(this).classed("line--hover", true);
                    console.log();
                }).on("mouseout", function () {
                    d3.select(this).classed("line--hover", false);
                });

        svg.append("text")
                .attr("class", "x label")
                .attr("text-anchor", "end")
                .attr("x", 500)
                .attr("y", 650)
                .text("	Number of Games Played");

        svg.append("text")
                .attr("class", "x label")
                .attr("text-anchor", "end")
                .attr("x", 60)
                .attr("y", 400)
                .text("Points");


    }



    function drawPie(){

        d3.selectAll("svg")
                .remove();
        d3.select("table")
                .remove();

        drawLinegraph();

        var width = 960,
                height = 500,
                radius = Math.min(width, height) / 2;

        var color = d3.scale.ordinal()
                .range(["#04B404", "#DF01D7"]);

        var arc = d3.svg.arc()
                .outerRadius(radius - 10)
                .innerRadius(0);

        var pie = d3.layout.pie()
                .sort(null)
                .value(function(d) { return d.population; });

        var svg = d3.select("body").append("svg")
                .attr("width", width)
                .attr("height", height)
                .append("g")
                .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

//        d3.csv("data.csv", function(error, data) {

//            data.forEach(function(d) {
//                d.population = +d.population;
//            });

        var data = [{age:"win", population: map[comparing[0]].numOfWins},
            {age:"lose", population: map[comparing[0]].numOfLosses}];

        //first pie
        var g = svg.selectAll(".arc")
                    .data(pie(data))
                    .enter().append("g")
                    .attr("class", "arc");

            g.append("path")
                    .attr("d", arc)
                    .style("fill", function(d) { return color(d.data.age); });

            g.append("text")
                    .attr("transform", function(d) { return "translate(" + arc.centroid(d) + ")"; })
                    .attr("dy", ".35em")
                    .style("text-anchor", "middle")
                    .style("font-size", "40px")
                    .text(function(d) {
                        var holder = d.data.age+": "+ d.data.population;
                        return holder; });



    }

//    age,population
//    <5,2704659
//    5-13,4499890
//    14-17,2159981
//    18-24,3853788
//    25-44,14106543
//    45-64,8819342
//    ≥65,612463




    function drawGraph(){
            d3.select("svg")
                    .remove();
        d3.select("table")
                .remove();
            w = 800;
            h = 800;
            var path = d3.geo.path();
            var svg = d3.select("body").select("#bar").append("svg").attr({
                width: w+200,
                height: h+200
            });
            var teams = new Array();
            var points = new Array();
        if(comparing.length<1) {
            for (var key in map) {
                teams.push(map[key]);
            }
        }else{
            for (var key in map) {
                if(teamPicked(map[key].name)){
                    teams.push(map[key]);
                }
//                alert(map[key].name);
            }
        }
            var bars = svg.selectAll("rect")
                    .data(teams)
                    .enter()
                    .append("rect")
                    .attr("width", 0)
                    .attr("height", 30)
                    .attr("fill", "white")
                    .attr("stroke-width", 2)
                    .attr("stroke", "white")
                    .transition()
                    .duration(1500)
                    .attr("fill", function(d){return TeamcolorPicker(d.name)})
                    .attr("width", function(d){return d.numOfWins*40;})
                    .attr("stroke", "black")
                    .attr("x", 300)
                    .attr("y", function(d, i){return i*30+12})
                    .attr("ry", 5);
            svg.selectAll("text")
                    .data(teams)
                    .enter()
                    .append("text")
                    .attr("fill", "white")
                    .attr("stroke", "white")
                    .transition()
                    .duration(1500)
                    .attr("fill", "white")
                    .attr("stroke", "white")
                    .attr("font-size", "14px")
                    .attr("x", 80)
                    .attr("y", function(d, i){return 30*i+30;})
                    .text(function(d, i){return d.name+" - "+d.numOfWins;});
            var rect = svg.selectAll("rect");
            rect.on("mouseover", function(d){
                rect.transition()
                        .duration(0)
                        .attr('opacity', 0.33);
                d3.select(this).transition()
                        .duration(500)
                        .attr('opacity', 1);

                var xPosition = parseFloat(d3.select(this).attr("x"));
                var yPosition = parseFloat(d3.select(this).attr("y")) / 2 + h / 2;

                //Update the tooltip position and value
                d3.select("#tooltip")
                        .style("left", xPosition + "px")
                        .style("top", yPosition + "px")
                        .select("#value")
                        .text(d.name+" "+ d.numOfWins+" wins");

                //Show the tooltip
                d3.select("#tooltip").classed("hidden", false);

            }).on("mouseout", function(){
                rect.transition()
                        .duration(0)
                        .attr('opacity', 1);
                d3.select("#tooltip").classed("hidden", true);
            });
        }






    function getMap(k) {
        return map[k];
    }
    function calculateTotalPointsPerSeason(ds) {
        ds.forEach(function (d) {
            if (d.Venue.length !== (0)) {
                getMap(d["Home Team"]).Total += d.Score1;
                getMap(d["Away Team"]).Total += d.Score1;
            }
        });
    }
    //calculate the total number of wins for each team
    //also games played
    function calculateTotalWinLoss() {
        ds.forEach(function (d) {
            if (d.Venue.length !== (0)) {
                getMap(d["Home Team"]).gamesPlayed++;
                getMap(d["Away Team"]).gamesPlayed++;
                var homeTeamScore = d.Score1;
                var awayTeamScore = d.Score2;
                if (homeTeamScore > awayTeamScore) {
                    getMap(d["Home Team"]).numOfWins++;
                    getMap(d["Away Team"]).numOfLosses++;
                } else if (homeTeamScore < awayTeamScore) {
                    getMap(d["Away Team"]).numOfWins++;
                    getMap(d["Home Team"]).numOfLosses++;
                } else {
                }
            }
        });
    }
    //compare the the score between two teams and determine
    //the winner
    function findWinner(team1, score1, team2, score2) {
        if (score1 > score2) {
            return team1;
        }
        if (score1 === score2) {
            return "draw";
        } else {
            return team2;
        }
    }
    function getOutcome(data){
        if(data>0){
            return 1;
        }
        else{
            return 0;
        }
    }
    function initializeTeams() {
        map["New South Wales Swifts"] = {
            name: "New South Wales Swifts",
            Total: 0,
            numOfWins: 0,
            numOfLosses: 0,
            points: 0,
            numOfGamesToPoints: [],
            gamesPlayed: 0,
            TotalScore: 0,
            TotalScoreAgainst: 0
        }
        map["Adelaide Thunderbirds"] = {
            name: "Adelaide Thunderbirds",
            Total: 0,
            numOfWins: 0,
            numOfLosses: 0,
            points: 0,
            numOfGamesToPoints: [],
            gamesPlayed: 0,
            TotalScore: 0,
            TotalScoreAgainst: 0
        }
        map["Queensland Firebirds"] = {
            name: "Queensland Firebirds",
            Total: 0,
            numOfWins: 0,
            numOfLosses: 0,
            points: 0,
            numOfGamesToPoints: [],
            gamesPlayed: 0,
            TotalScore: 0,
            TotalScoreAgainst: 0
        }
        map["Melbourne Vixens"] = {
            name: "Melbourne Vixens",
            Total: 0,
            numOfWins: 0,
            numOfLosses: 0,
            points: 0,
            numOfGamesToPoints: [],
            gamesPlayed: 0,
            TotalScore: 0,
            TotalScoreAgainst: 0
        }
        map["Northern Mystics"] = {
            name: "Northern Mystics",
            Total: 0,
            numOfWins: 0,
            numOfLosses: 0,
            points: 0,
            numOfGamesToPoints: [],
            gamesPlayed: 0,
            TotalScore: 0,
            TotalScoreAgainst: 0
        }
        map["Central Pulse"] = {
            name: "Central Pulse",
            Total: 0,
            numOfWins: 0,
            numOfLosses: 0,
            points: 0,
            numOfGamesToPoints: [],
            gamesPlayed: 0,
            TotalScore: 0,
            TotalScoreAgainst: 0
        }
        map["Southern Steel"] = {
            name: "Southern Steel",
            Total: 0,
            numOfWins: 0,
            numOfLosses: 0,
            points: 0,
            numOfGamesToPoints: [],
            gamesPlayed: 0,
            TotalScore: 0,
            TotalScoreAgainst: 0
        }
        map["Waikato Bay of Plenty Magic"] = {
            name: "Waikato Bay of Plenty Magic",
            Total: 0,
            numOfWins: 0,
            numOfLosses: 0,
            points: 0,
            numOfGamesToPoints: [],
            gamesPlayed: 0,
            TotalScore: 0,
            TotalScoreAgainst: 0
        }
        map["West Coast Fever"] = {
            name: "West Coast Fever",
            Total: 0,
            numOfWins: 0,
            numOfLosses: 0,
            points: 0,
            numOfGamesToPoints: [],
            gamesPlayed: 0,
            TotalScore: 0,
            TotalScoreAgainst: 0
        }
        map["Canterbury Tactix"] = {
            name: "Canterbury Tactix",
            Total: 0,
            numOfWins: 0,
            numOfLosses: 0,
            points: 0,
            numOfGamesToPoints: [],
            gamesPlayed: 0,
            TotalScore: 0,
            TotalScoreAgainst: 0
        }
        //console.log(teams);
    }

    function teamPicked(team){
        for(var i =0; i<comparing.length;i++){
            if(team===comparing[i]){
                return true;
            }
        }
        return false;
    }

    function TeamcolorPicker(team) {
        if (team === ("New South Wales Swifts")) {
            return "#2E2EFE";
        }
        if (team === ("Waikato Bay of Plenty Magic")) {
            return "#D0FA58";
        }
        if (team === ("Southern Steel")) {
            return "#088A85";
        }
        if (team === ("Central Pulse")) {
            return "#FFFF00";
        }
        if (team === ("Northern Mystics")) {
            return "#240B3B";
        }
        if (team === ("Melbourne Vixens")) {
            return "#04B404";
        }
        if (team === ("Queensland Firebirds")) {
            return "#FF8000";
        }
        if (team === ("Adelaide Thunderbirds")) {
            return "#DF01D7";
        }
        if (team === ("Canterbury Tactix")) {
            return "#FF0000";
        }
        if (team === ("West Coast Fever")) {
            return "#0B3B17";
        }
    }

/////////////////////// TEAM BUTTONS///////////////////////////////////////////////////
//central pulse buttons
function mouseOverPulseMDown() {
    document.images["pulseButton"].src = "data/CentralPulse.png";
    return true;
}
var pulseUp = false;
function mouseOverPulseMUp() {
    if (pulseUp == false) {
        //console.log("Pushing pulse");
        comparing.push("Central Pulse");
        document.images["pulseButton"].src = "data/white/CentralPulseWhite.jpg";
    }
    if (pulseUp == false) {
        pulseUp = true;
    }
    else {
        //console.log("Removing pulse");
        var index = comparing.indexOf("Central Pulse");
        if (index > -1) {
            comparing.splice(index, 1);
        }
        pulseUp = false;
    }
    //console.log(comparing);
    currentYear = getYearForm();
    currentRound = getRoundForm();
    d3.select("svg").remove();
    manipulateData();
    return true;
}
//northern mystics buttons
function mouseOverMysticsMDown() {
    document.images["mysticsButton"].src = "data/NorthernMystics.png";
    return true;
}
var mysticsUp = false;
function mouseOverMysticsMUp() {
    if (mysticsUp == false) {
        //console.log("Pushing mystics");
        comparing.push("Northern Mystics");
        document.images["mysticsButton"].src = "data/white/NorthernMysticsWhite.jpg";
    }
    if (mysticsUp == false) {
        mysticsUp = true;
    }
    else {
        //console.log("Removing mystics");
        var index = comparing.indexOf("Northern Mystics");
        if (index > -1) {
            comparing.splice(index, 1);
        }
        mysticsUp = false;
    }
    //console.log(comparing);
    currentYear = getYearForm();
    currentRound = getRoundForm();
    d3.select("svg").remove();
    manipulateData();
    return true;
}
//magic button
function mouseOverMagicMDown() {
    document.images["magicButton"].src = "data/WaikatoBayofPlentyMagic.png";
    return true;
}
var magicUp = false;
function mouseOverMagicMUp() {
    if (magicUp == false) {
        //console.log("Pushing magic");
        comparing.push("Waikato Bay of Plenty Magic");
        document.images["magicButton"].src = "data/white/WaikatoBayofPlentyMagicWhite.jpg";
    }
    if (magicUp == false) {
        magicUp = true;
    }
    else {
        //console.log("Removing magic");
        var index = comparing.indexOf("Waikato Bay of Plenty Magic");
        if (index > -1) {
            comparing.splice(index, 1);
        }
        magicUp = false;
    }
    //console.log(comparing);
    currentYear = getYearForm();
    currentRound = getRoundForm();
    d3.select("svg").remove();
    manipulateData();
    return true;
}
//steel button
function mouseOverSteelMDown() {
    document.images["steelButton"].src = "data/SouthernSteel.png";
    return true;
}
var steelUp = false;
function mouseOverSteelMUp() {
    if (steelUp == false) {
        //console.log("Pushing steel");
        comparing.push("Southern Steel");
        document.images["steelButton"].src = "data/white/SouthernSteelWhite.jpg";
    }
    if (steelUp == false) {
        steelUp = true;
    }
    else {
        //console.log("Removing steel");
        var index = comparing.indexOf("Southern Steel");
        if (index > -1) {
            comparing.splice(index, 1);
        }
        steelUp = false;
    }
    //console.log(comparing);
    currentYear = getYearForm();
    currentRound = getRoundForm();
    d3.select("svg").remove();
    manipulateData();
    return true;
}
//canterbury tactix button
function mouseOverTactixMDown() {
    document.images["tactixButton"].src = "data/CanterburyTactix.png";
    return true;
}
var tactixUp = false;
function mouseOverTactixMUp() {
    if (tactixUp == false) {
        console.log("Pushing tactix");
        comparing.push("Canterbury Tactix");
        document.images["tactixButton"].src = "data/white/CanterburyTactixWhite.jpg";
    }
    if (tactixUp == false) {
        tactixUp = true;
    }
    else {
        console.log("Removing tactix");
        var index = comparing.indexOf("Canterbury Tactix");
        if (index > -1) {
            comparing.splice(index, 1);
        }
        tactixUp = false;
    }
    //console.log(comparing);
    currentYear = getYearForm();
    currentRound = getRoundForm();
    d3.select("svg").remove();
    manipulateData();
    return true;
}
//nsw swifts buttons
function mouseOverSwiftsMDown() {
    document.images["swiftsButton"].src = "data/NewSouthWalesSwifts.png";
    return true;
}
var swiftsUp = false;
function mouseOverSwiftsMUp() {
    if (swiftsUp == false) {
        //console.log("Pushing swifts");
        comparing.push("New South Wales Swifts");
        document.images["swiftsButton"].src = "data/white/NewSouthWalesSwiftsWhite.jpg";
    }
    if (swiftsUp == false) {
        swiftsUp = true;
    }
    else {
        console.log("Removing swifts");
        var index = comparing.indexOf("New South Wales Swifts");
        if (index > -1) {
            comparing.splice(index, 1);
        }
        swiftsUp = false;
    }
    //console.log(comparing);
    currentYear = getYearForm();
    currentRound = getRoundForm();
    d3.select("svg").remove();
    manipulateData();
    return true;
}
// adeliade thundebrids buttons
function mouseOverThunderMDown() {
    document.images["thunderButton"].src = "data/AdelaideThunderbirds.png";
    return true;
}
var thunderUp = false;
function mouseOverThunderMUp() {
    if (thunderUp == false) {
        //console.log("Pushing thunder");
        comparing.push("Adelaide Thunderbirds");
        document.images["thunderButton"].src = "data/white/AdelaideThunderbirdsWhite.jpg";
    }
    //console.log(comparing);
    if (thunderUp == false) {

        thunderUp = true;
    }
    else {
        //console.log("Removing thunder");
        var index = comparing.indexOf("Adelaide Thunderbirds");
        if (index > -1) {
            comparing.splice(index, 1);
        }
        thunderUp = false;
    }
    console.log(comparing);
    currentYear = getYearForm();
    currentRound = getRoundForm();
    d3.select("svg").remove();
    manipulateData();
    return true;
}
//melbourne vixens buttons
function mouseOverVixensMDown() {
    document.images["vixensButton"].src = "data/MelbourneVixens.png";
    return true;
}
var vixensUp = false;
function mouseOverVixensMUp() {
    if (vixensUp == false) {
        //console.log("Pushing vixens");
        comparing.push("Melbourne Vixens");
        document.images["vixensButton"].src = "data/white/MelbourneVixensWhite.jpg";
    }
    if (vixensUp == false) {
        vixensUp = true;
    }
    else {
        //console.log("Removing vixens");
        var index = comparing.indexOf("Melbourne Vixens");
        if (index > -1) {
            comparing.splice(index, 1);
        }
        vixensUp = false;
    }
    console.log(comparing);
    currentYear = getYearForm();
    currentRound = getRoundForm();
    d3.select("svg").remove();
    manipulateData();
    return true;
}
//fever button
function mouseOverFeverMDown() {
    document.images["feverButton"].src = "data/WestCoastFever.png";
    return true;
}
var feverUp = false;
function mouseOverFeverMUp() {
    if (feverUp == false) {
        //console.log("Pushing fever");
        comparing.push("West Coast Fever");
        document.images["feverButton"].src = "data/white/WestCoastFeverWhite.jpg";
    }
    if (feverUp == false) {
        feverUp = true;
    }
    else {
        //console.log("Removing fever");
        var index = comparing.indexOf("West Coast Fever");
        if (index > -1) {
            comparing.splice(index, 1);
        }
        feverUp = false;
    }
    console.log(comparing);
    currentYear = getYearForm();
    currentRound = getRoundForm();
    d3.select("svg").remove();
    manipulateData();
    return true;
}
//firebirds button
function mouseOverFirebirdsMDown() {
    document.images["firebirdsButton"].src = "data/QueenslandFirebirds.png";
    return true;
}
var firebirdsUp = false;
function mouseOverFirebirdsMUp() {
    if (firebirdsUp == false) {
        //console.log("Pushing firebirds");
        comparing.push("Queensland Firebirds");
        document.images["firebirdsButton"].src = "data/white/QueenslandFirebirdsWhite.jpg";
    }
    if (firebirdsUp == false) {
        firebirdsUp = true;
    }
    else {
        //console.log("Removing firebirds");
        var index = comparing.indexOf("Queensland Firebirds");
        if (index > -1) {
            comparing.splice(index, 1);
        }
        firebirdsUp = false;
    }
    console.log(comparing);
    currentYear = getYearForm();
    currentRound = getRoundForm();
    d3.select("svg").remove();
    manipulateData();
    return true;
}
d3.select("body").style("background-color", "#58ACFA");
    //currentYear = getYearForm();
    //currentRound = getRoundForm();
</script>


<!-- TOTAL WINS GRAPH ENDS //////////////////////////////////////////////////////////// -->

</body>
</html>

